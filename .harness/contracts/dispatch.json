{
  "meta": {
    "version": "harness.v1"
  },
  "work_orders": [
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/doctor.py",
          "name": "doctor"
        },
        {
          "cmd": "python3 .harness/tools/verify.py --check schema",
          "name": "verify-schema"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [],
      "done": true,
      "id": "WO-0001",
      "priority": 1,
      "ready": false,
      "role": "MAYOR",
      "scope": {
        "allow_globs": [
          ".harness/**",
          "docs/**",
          "contracts/**",
          "README.md",
          "Taskfile.yml",
          "receipts/**",
          "docs/STATUS.md"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Create docs/METRICS.md, docs/INVARIANTS.md, docs/LIFECYCLE.md, and docs/VERSIONING.md from the SDD.",
        "Create contracts/metrics_catalog.json from the SDD.",
        "Create docs/OPEN_QUESTIONS.md if any gaps exist.",
        "Replace .harness/contracts/dispatch.json with atomic work orders.",
        "Mark WO-0001 done only after schema validation passes."
      ],
      "title": "Mayor: plan ABM from SDD"
    },
    {
      "acceptance": [
        {
          "cmd": "test -s docs/METRICS.md",
          "name": "metrics-doc"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0001"
      ],
      "done": true,
      "id": "WO-0002",
      "priority": 2,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Create docs/METRICS.md with the ABM metrics taxonomy from the SDD."
      ],
      "title": "Docs: metrics taxonomy"
    },
    {
      "acceptance": [
        {
          "cmd": "test -s docs/INVARIANTS.md",
          "name": "invariants-doc"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0002"
      ],
      "done": true,
      "id": "WO-0003",
      "priority": 3,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Create docs/INVARIANTS.md with ABM invariants from the SDD."
      ],
      "title": "Docs: invariants"
    },
    {
      "acceptance": [
        {
          "cmd": "test -s docs/LIFECYCLE.md",
          "name": "lifecycle-doc"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0003"
      ],
      "done": true,
      "id": "WO-0004",
      "priority": 4,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Create docs/LIFECYCLE.md with the ABM emission lifecycle from the SDD."
      ],
      "title": "Docs: lifecycle"
    },
    {
      "acceptance": [
        {
          "cmd": "test -s docs/VERSIONING.md",
          "name": "versioning-doc"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0004"
      ],
      "done": true,
      "id": "WO-0005",
      "priority": 5,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Create docs/VERSIONING.md with ABM extension rules from the SDD."
      ],
      "title": "Docs: versioning"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 -c \"import json; json.load(open('contracts/metrics_catalog.json'))\"",
          "name": "metrics-catalog-json"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0005"
      ],
      "done": true,
      "id": "WO-0006",
      "priority": 6,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "contracts/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Create contracts/metrics_catalog.json from the SDD taxonomy."
      ],
      "title": "Contracts: metrics catalog"
    },
    {
      "acceptance": [
        {
          "cmd": "test -s docs/OPEN_QUESTIONS.md",
          "name": "open-questions-doc"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0006"
      ],
      "done": true,
      "id": "WO-0007",
      "priority": 7,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Create docs/OPEN_QUESTIONS.md capturing gaps or ambiguities from the SDD."
      ],
      "title": "Docs: open questions"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check schema",
          "name": "verify-schema"
        },
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "verify-work"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0007"
      ],
      "done": true,
      "id": "WO-0008",
      "priority": 8,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement: Agentic Base Metrics (ABM)",
        "Update docs/99-ops/status.md with what changed and how verified",
        "Run: python3 .harness/tools/verify.py --check work"
      ],
      "title": "Agentic Base Metrics (ABM)"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check schema",
          "name": "verify-schema"
        },
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "verify-work"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0008"
      ],
      "done": true,
      "id": "WO-0009",
      "priority": 9,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement: 2.4 Verification",
        "Update docs/99-ops/status.md with what changed and how verified",
        "Run: python3 .harness/tools/verify.py --check work"
      ],
      "title": "2.4 Verification"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check schema",
          "name": "verify-schema"
        },
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "verify-work"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0009"
      ],
      "done": true,
      "id": "WO-0010",
      "priority": 10,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement: 4. Metrics Taxonomy",
        "Update docs/99-ops/status.md with what changed and how verified",
        "Run: python3 .harness/tools/verify.py --check work"
      ],
      "title": "4. Metrics Taxonomy"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check schema",
          "name": "verify-schema"
        },
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "verify-work"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0010"
      ],
      "done": true,
      "id": "WO-0011",
      "priority": 11,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement: 4.1 Execution Metrics",
        "Update docs/99-ops/status.md with what changed and how verified",
        "Run: python3 .harness/tools/verify.py --check work"
      ],
      "title": "4.1 Execution Metrics"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check schema",
          "name": "verify-schema"
        },
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "verify-work"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0011"
      ],
      "done": true,
      "id": "WO-0012",
      "priority": 12,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement: 4.2 Coordination Metrics",
        "Update docs/99-ops/status.md with what changed and how verified",
        "Run: python3 .harness/tools/verify.py --check work"
      ],
      "title": "4.2 Coordination Metrics"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check schema",
          "name": "verify-schema"
        },
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "verify-work"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0012"
      ],
      "done": true,
      "id": "WO-0013",
      "priority": 13,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement: 4.3 Verification Metrics",
        "Update docs/99-ops/status.md with what changed and how verified",
        "Run: python3 .harness/tools/verify.py --check work"
      ],
      "title": "4.3 Verification Metrics"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check schema",
          "name": "verify-schema"
        },
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "verify-work"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0013"
      ],
      "done": true,
      "id": "WO-0014",
      "priority": 14,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/contracts/dispatch.json",
          "receipts/**",
          "docs/STATUS.md",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement: 4.4 Cost Metrics",
        "Update docs/99-ops/status.md with what changed and how verified",
        "Run: python3 .harness/tools/verify.py --check work"
      ],
      "title": "4.4 Cost Metrics"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "check-1"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0014"
      ],
      "done": true,
      "id": "WO-0015",
      "priority": 15,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/**",
          "receipts/**",
          "artifacts/**",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Create an ABM metric-event contract (strict JSON schema) reflecting SDD entities: Run, WorkOrder, ExecutionCycle, Agent, VerificationResult, MetricEvent.",
        "Define required linkage keys: run_id, dispatch_hash, head, work_order_id, cycle_id, agent_id; timestamps UTC.",
        "Define taxonomy enums per SDD section 4: execution/coordination/verification/cost; and lifecycle events per SDD section 6.",
        "Document contract + mutability rules (append-only) consistent with SDD section 5.3.",
        "Update docs/99-ops/status.md with verification notes."
      ],
      "title": "ABM substrate: define metric event contract + emission lifecycle (SDD 4-6)"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "check-1"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0015"
      ],
      "done": true,
      "id": "WO-0016",
      "priority": 16,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/**",
          "receipts/**",
          "artifacts/**",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement append-only ABM event emission during Ralph execution cycles:",
        "- cycle_start / cycle_end",
        "- attempt_start / attempt_end",
        "- verify_start / verify_result",
        "- state_transition (ready/promoted/done)",
        "Events must be attributable to (work_order_id, cycle_id) and written deterministically.",
        "Do NOT change scheduling/orchestration behavior; only emit facts.",
        "Store events under artifacts/abm/events.jsonl (append-only) or equivalent ABM artifact path.",
        "Update docs/99-ops/status.md with what changed and how verified."
      ],
      "title": "ABM emission: instrument Ralph loop to emit cycle/attempt/verification events (SDD 6.1)"
    },
    {
      "acceptance": [
        {
          "cmd": "test -f artifacts/abm/aggregates.json",
          "name": "check-1"
        },
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "check-2"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0016"
      ],
      "done": false,
      "id": "WO-0017",
      "priority": 17,
      "ready": true,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/**",
          "receipts/**",
          "artifacts/**",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement post-hoc aggregation that reads ABM event log and produces deterministic aggregates.",
        "Aggregates must be derived-only; must not influence execution.",
        "Write aggregates to artifacts/abm/aggregates.json (deterministic ordering).",
        "Update docs/99-ops/status.md with verification notes."
      ],
      "title": "ABM aggregation: derive replayable aggregates post-run only (SDD 6.2)"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "check-1"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0017"
      ],
      "done": false,
      "id": "WO-0018",
      "priority": 18,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/**",
          "receipts/**",
          "artifacts/**",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Add a deterministic check: rerun aggregator over the same event log and assert identical aggregates (byte-for-byte or canonical-json stable).",
        "Add or extend a verifier check ensuring replay determinism holds.",
        "Update docs/99-ops/status.md with verification notes."
      ],
      "title": "ABM replay determinism: re-run aggregation and assert identical output (SDD 7)"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check work",
          "name": "check-1"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0018"
      ],
      "done": false,
      "id": "WO-0019",
      "priority": 19,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/**",
          "receipts/**",
          "artifacts/**",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Implement detection (emit metric events and fail verification where appropriate) for:",
        "- silent execution (WO done without required events)",
        "- zero progress (cycles without completes beyond threshold)",
        "- verification deadlock (repeated verify fails without state change)",
        "- infinite loop risk (cycle count exceeds bound)",
        "ABM must detect, not fix. Use deterministic thresholds documented in docs/INVARIANTS.md.",
        "Update docs/99-ops/status.md with what changed and how verified."
      ],
      "title": "ABM guardrails: detect silent execution + zero progress + deadlock signals (SDD 9)"
    },
    {
      "acceptance": [
        {
          "cmd": "python3 .harness/tools/verify.py --check dod",
          "name": "check-1"
        }
      ],
      "artifacts": {
        "receipt_required": true
      },
      "depends_on": [
        "WO-0019"
      ],
      "done": false,
      "id": "WO-0020",
      "priority": 20,
      "ready": false,
      "role": "WORKER",
      "scope": {
        "allow_globs": [
          "docs/**",
          "contracts/**",
          ".harness/**",
          "receipts/**",
          "artifacts/**",
          "README.md",
          "Taskfile.yml"
        ],
        "deny_globs": [
          "**/.env",
          "**/*.pem",
          "**/*token*",
          "**/package-lock.json",
          "**/yarn.lock",
          "**/__pycache__/**",
          "**/*.pyc"
        ]
      },
      "steps": [
        "Run Ralph loop to terminal RUN_DONE.",
        "Ensure ABM event log exists and contains per-cycle and verification events for each work order execution cycle.",
        "Ensure aggregates exist and replay determinism check passes.",
        "Ensure no silent execution exists (new ABM checks).",
        "Update docs/STATUS.md with Phase 3 completion and artifact locations."
      ],
      "title": "ABM Phase 3 proof: run to RUN_DONE and enforce ABM DoD additions"
    }
  ]
}
