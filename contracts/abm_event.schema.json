{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "ABM Event",
  "type": "object",
  "required": [
    "event_version",
    "event_type",
    "timestamp_utc",
    "run_id",
    "dispatch_hash",
    "head",
    "work_order_id",
    "cycle_id",
    "agent_id",
    "detail"
  ],
  "properties": {
    "event_version": {
      "type": "string",
      "const": "abm.event.v1"
    },
    "event_type": {
      "type": "string",
      "enum": [
        "cycle_start",
        "cycle_end",
        "attempt_start",
        "attempt_end",
        "verify_start",
        "verify_result",
        "state_transition"
      ]
    },
    "timestamp_utc": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.*"
    },
    "run_id": {
      "type": "string"
    },
    "dispatch_hash": {
      "type": "string"
    },
    "head": {
      "type": "string"
    },
    "work_order_id": {
      "type": ["string", "null"]
    },
    "cycle_id": {
      "type": ["string", "null"]
    },
    "agent_id": {
      "type": "string"
    },
    "detail": {
      "type": "object"
    }
  },
  "additionalProperties": false
}
